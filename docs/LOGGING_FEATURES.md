# VADC è¯¦ç»†æ—¥å¿—å’ŒéŸ³é¢‘ä¿å­˜åŠŸèƒ½

æœ¬æ›´æ–°ä¸º VADC æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—è®°å½•å’ŒéŸ³é¢‘æµä¿å­˜åŠŸèƒ½ï¼Œæ–¹ä¾¿è°ƒè¯•å’Œåˆ†æã€‚

## æ–°å¢åŠŸèƒ½

### 1. è¯¦ç»†æ—¥å¿—è¾“å‡º (`--verbose`)

å¯ç”¨è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºï¼Œæ˜¾ç¤ºæ‰€æœ‰æ£€æµ‹åˆ°çš„è¯­éŸ³äº‹ä»¶å’Œç³»ç»Ÿä¿¡æ¯ã€‚

```bash
cd /path/to/vadc
arecord -f S16_LE -c 1 -r 16000 -q - | ./build/vadc --stdin --verbose
```

**è¾“å‡ºç¤ºä¾‹:**
```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
VADC - è¯­éŸ³æ´»åŠ¨æ£€æµ‹ç³»ç»Ÿ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
å‚æ•°é…ç½®:
  è¯´è¯æ¦‚ç‡é˜ˆå€¼: 0.50
  æœ€å°æ²‰é»˜æ—¶é•¿: 200ms
  æœ€å°è¯´è¯æ—¶é•¿: 250ms
  è¯­éŸ³è¾¹ç•Œå¡«å……: 30ms
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¤ äº‹ä»¶ #1 | è¯´è¯: 0.10-0.50ç§’ (æ—¶é•¿: 0.40ç§’) | æ¦‚ç‡: 85.20%
ğŸ¤ äº‹ä»¶ #2 | è¯´è¯: 1.20-1.80ç§’ (æ—¶é•¿: 0.60ç§’) | æ¦‚ç‡: 92.10%
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
æ£€æµ‹å®Œæˆ
  æ€»å¤„ç†æ—¶é•¿: 3.24ç§’
  æ£€æµ‹åˆ°è¯­éŸ³äº‹ä»¶: 2
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 2. éŸ³é¢‘æµä¿å­˜ (`--save_audio`)

å°†è·å–çš„åŸå§‹éŸ³é¢‘ (16-bit PCM, 16kHz) ä¿å­˜åˆ°æ–‡ä»¶ï¼Œä¾›åç»­æ’­æ”¾æˆ–åˆ†æã€‚

```bash
arecord -f S16_LE -c 1 -r 16000 -q - | ./build/vadc --stdin --save_audio my_audio.raw
```

**æ’­æ”¾ä¿å­˜çš„éŸ³é¢‘:**
```bash
# ä½¿ç”¨ aplay
aplay -f S16_LE -r 16000 -c 1 my_audio.raw

# æˆ–è½¬æ¢ä¸º WAV
sox -t raw -r 16000 -b 16 -c 1 -e signed-integer my_audio.raw audio.wav
aplay audio.wav
```

### 3. æ—¥å¿—ä¿å­˜ (`--save_log`)

å°†æ£€æµ‹æ—¥å¿—ä¿å­˜åˆ°æ–‡ä»¶ï¼Œä¾¿äºäº‹ååˆ†æå’Œè°ƒè¯•ã€‚

```bash
arecord -f S16_LE -c 1 -r 16000 -q - | ./build/vadc --stdin --save_log detection.log
```

### 4. ç»„åˆä½¿ç”¨

ä¸€æ¬¡æ€§å¯ç”¨æ‰€æœ‰åŠŸèƒ½ï¼š

```bash
arecord -f S16_LE -c 1 -r 16000 -q - | \
  ./build/vadc --stdin \
    --verbose \
    --save_audio speech.raw \
    --save_log speech.log \
    --stats
```

## ä¾¿æ·è„šæœ¬

ä½¿ç”¨ `run_vadc_with_logging.sh` å¿«é€Ÿå¯åŠ¨ï¼š

### å®æ—¶æ£€æµ‹ï¼ˆå«è¯¦ç»†æ—¥å¿—ï¼‰
```bash
./run_vadc_with_logging.sh run
```

### è°ƒè¯•æ¨¡å¼ï¼ˆè‡ªåŠ¨ä¿å­˜éŸ³é¢‘å’Œæ—¥å¿—ï¼‰
```bash
./run_vadc_with_logging.sh debug my_test
```

è¿™ä¼šç”Ÿæˆï¼š
- `my_test_audio.raw` - åŸå§‹éŸ³é¢‘
- `my_test_log.txt` - æ£€æµ‹æ—¥å¿—

ç„¶åå¯ä»¥ï¼š
```bash
# æ’­æ”¾éŸ³é¢‘
aplay -f S16_LE -r 16000 -c 1 my_test_audio.raw

# æŸ¥çœ‹æ—¥å¿—
cat my_test_log.txt
```

### å½•åˆ¶å’Œå›æ”¾
```bash
# å½•åˆ¶ 5 ç§’
timeout 5 ./run_vadc_with_logging.sh record my_voice.wav

# å¤„ç†å½•åˆ¶çš„æ–‡ä»¶
./run_vadc_with_logging.sh playback my_voice.wav --verbose
```

##å…¨éƒ¨å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `--verbose` | å¯ç”¨è¯¦ç»†æ—¥å¿—è¾“å‡º | `--verbose` |
| `--stats` | æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ | `--stats` |
| `--save_audio <æ–‡ä»¶>` | ä¿å­˜åŸå§‹éŸ³é¢‘ | `--save_audio audio.raw` |
| `--save_log <æ–‡ä»¶>` | ä¿å­˜æ£€æµ‹æ—¥å¿— | `--save_log log.txt` |
| `--threshold <å€¼>` | è¯´è¯æ¦‚ç‡é˜ˆå€¼ (0.0-1.0) | `--threshold 0.6` |
| `--min_speech <ms>` | æœ€å°è¯´è¯æ—¶é•¿ | `--min_speech 300` |
| `--min_silence <ms>` | æœ€å°æ²‰é»˜æ—¶é•¿ | `--min_silence 250` |
| `--stdin` | ä»æ ‡å‡†è¾“å…¥è¯»å– | `--stdin` |

## ç¼–è¯‘

æ–°åŠŸèƒ½å·²é›†æˆï¼Œç›´æ¥ç¼–è¯‘å³å¯ï¼š

```bash
cd /path/to/vadc
mkdir -p build
cd build
cmake -DCMAKE_BUILD_TYPE=Release ..
make -j4
```

## åŸå§‹éŸ³é¢‘æ ¼å¼

ä¿å­˜çš„éŸ³é¢‘æ ¼å¼ï¼š
- **æ ¼å¼**: PCM (Pulse Code Modulation)
- **ä½æ·±**: 16-bit
- **é‡‡æ ·ç‡**: 16000 Hz (16kHz)
- **é€šé“**: å•å£°é“ (Mono)
- **å­—èŠ‚åº**: å°ç«¯ (Little Endian)

è½¬æ¢ä¸ºå…¶ä»–æ ¼å¼ï¼š

```bash
# è½¬ WAV
sox -t raw -r 16000 -b 16 -c 1 -e signed-integer audio.raw audio.wav

# è½¬ MP3
sox -t raw -r 16000 -b 16 -c 1 -e signed-integer audio.raw audio.mp3

# è½¬ OGG
sox -t raw -r 16000 -b 16 -c 1 -e signed-integer audio.raw audio.ogg

# è½¬ FLAC
sox -t raw -r 16000 -b 16 -c 1 -e signed-integer audio.raw audio.flac
```

## å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæˆæ—¥å¿—æ–‡ä»¶?**
- ç¡®ä¿æŒ‡å®šäº† `--save_log` å‚æ•°
- æ£€æŸ¥ç›®å½•æ˜¯å¦æœ‰å†™æƒé™
- å°è¯•æŒ‡å®šç»å¯¹è·¯å¾„

**Q: éŸ³é¢‘æ–‡ä»¶å¾ˆå¤§å—?**
- 16-bit 16kHz mono = 32,000 å­—èŠ‚/ç§’
- 10 åˆ†é’Ÿçš„éŸ³é¢‘ â‰ˆ 19.2 MB

**Q: å¯ä»¥å¤„ç†åçš„å®æ—¶æ’­æ”¾å—?**
- å¯ä»¥ç”¨ç®¡é“ï¼š`./build/vadc --stdin | aplay`
- ä½†éœ€è¦ä¿è¯å¤„ç†é€Ÿåº¦å¿«äºå®æ—¶

## æ€§èƒ½è¯´æ˜

- æ—¥å¿—è¾“å‡ºä¼šç•¥å¾®å¢åŠ å¤„ç†æ—¶é—´ (~5-10%)
- éŸ³é¢‘ä¿å­˜éœ€è¦é¢å¤– I/Oï¼Œå¯èƒ½å½±å“å®æ—¶æ€§
- å»ºè®®è°ƒè¯•æ—¶ä½¿ç”¨ï¼Œç”Ÿäº§ç¯å¢ƒå¯å…³é—­è¿™äº›åŠŸèƒ½
